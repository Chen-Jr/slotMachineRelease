(function(){"use strict";var t={873:function(t,e,s){var i=s(5130),n=s(6768);const a={id:"app"};function o(t,e,s,i,o,r){const l=(0,n.g2)("router-view");return(0,n.uX)(),(0,n.CE)("div",a,[(0,n.bF)(l)])}var r={name:"App"},l=s(1241);const c=(0,l.A)(r,[["render",o]]);var u=c,h=s(1387),g=s(4232);const d={id:"SlotMachine"},f={class:"body"},p={class:"window"},m={class:"container"},y={class:"resultList-container"};function v(t,e,s,a,o,r){const l=(0,n.g2)("GiftDemo");return(0,n.uX)(),(0,n.CE)("div",d,[e[7]||(e[7]=(0,n.Lk)("div",{class:"badge"},[(0,n.Lk)("span",null,"SlotMachine")],-1)),(0,n.Lk)("div",f,[(0,n.Lk)("div",p,[(0,n.Lk)("div",m,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.configs,((t,e)=>((0,n.uX)(),(0,n.Wv)(l,{onFinished:r.isFinished,trigger:o.trigger,config:t,key:e},null,8,["onFinished","trigger","config"])))),128)),e[3]||(e[3]=(0,n.Lk)("div",{class:"fence1"},null,-1)),e[4]||(e[4]=(0,n.Lk)("div",{class:"fence2"},null,-1))])]),(0,n.Lk)("div",{class:(0,g.C4)(["handler",{active:o.active},{disabled:o.disabled}])},[e[5]||(e[5]=(0,n.Lk)("div",{class:"stick2"},null,-1)),e[6]||(e[6]=(0,n.Lk)("div",{class:"stick"},null,-1)),(0,n.Lk)("div",{class:"ball",onClick:e[0]||(e[0]=t=>!o.disabled&&r.turn())})],2)]),(0,n.Lk)("div",{class:"history",onClick:e[1]||(e[1]=t=>o.openResultList=!0)}," OPEN RESULT "),(0,n.Lk)("div",{onClick:e[2]||(e[2]=(0,i.D$)((t=>o.openResultList=!1),["self"])),class:(0,g.C4)(["resultList",{openResultList:o.openResultList}])},[(0,n.Lk)("div",y,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.resultList,((t,e)=>((0,n.uX)(),(0,n.CE)("div",{class:"result",key:e},(0,g.v_)(`Round${e+1}: ${t}`),1)))),128))])],2),e[8]||(e[8]=(0,n.Lk)("div",{class:"github"},null,-1))])}s(4114),s(8111),s(1701);const k=["北","南","东","西"],b=["乾","兑","离","震","巽","坎","艮","坤"],L=["丁","午","丙","巳","巽","辰","乙","卯","甲","寅","良","壬","癸","子","丑","亥","乾","戌","辛","酉","庚","申","坤","未"],D={"东":["震","巽","艮"],"南":["巽","离","坤"],"西":["兑","坤","乾"],"北":["坎","艮","乾"]},C={"离":["丁","午","丙"],"巽":["巳","巽","辰"],"震":["乙","卯","甲"],"艮":["寅","良","丑"],"坎":["癸","子","壬"],"乾":["亥","乾","戌"],"兑":["辛","酉","庚"],"坤":["申","坤","未"]},S=["src","height"];function $(t,e,s,i,a,o){return(0,n.uX)(),(0,n.CE)("div",{class:(0,g.C4)(["gift-container",o.displayType,{autoTurn:a.isRunning}])},[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(s.config.gifts,((t,e)=>((0,n.uX)(),(0,n.CE)("div",{class:(0,g.C4)(["gift",s.config.style]),key:e,style:(0,g.Tr)(`transform: rotateX(${o.rotate*e}deg) translateZ(${o.translateZ}px)`)},["text"===t.type?((0,n.uX)(),(0,n.CE)(n.FK,{key:0},[(0,n.eW)((0,g.v_)(t.name),1)],64)):(0,n.Q3)("",!0),"image"===t.type?((0,n.uX)(),(0,n.CE)("img",{key:1,src:t.path,height:s.config.height},null,8,S)):(0,n.Q3)("",!0)],6)))),128))],2)}s(7588);var E={name:"GiftDemo",props:{trigger:{type:Date,default:!1},config:{type:Object,required:!0}},data(){return{isRunning:!1,currentDeg:0,targetDeg:0,giftsDeg:[]}},computed:{displayType(){return this.config.run3D?"three-dimension":"flat"},rotate(){return 360/this.config.gifts.length},translateZ(){return this.config.height/2/Math.tan(this.rotate/2/180*Math.PI)}},watch:{config:{handler(){this.setConfig()},deep:!0},trigger(){this.autoTurn()},isRunning(){this.isRunning&&setTimeout((()=>{this.autoTurnStop()}),this.config.duration+200)}},mounted(){this.setConfig(),this.logGiftsDeg()},unmounted(){console.log("组件已卸载")},methods:{logGiftsDeg(){this.config.gifts.forEach(((t,e)=>{this.giftsDeg[e]={from:0===e?0:this.giftsDeg[e-1].to,to:0===e?this.rotate:this.giftsDeg[e-1].to+this.rotate,name:t.name}}))},setConfig(){this.$el.style.setProperty("--rotateY",`${this.config.rotateY}deg`),this.$el.style.setProperty("--duration",`${this.config.duration}ms`),this.$el.style.setProperty("--fontSize",`${this.config.fontSize}px`),this.$el.style.setProperty("--height",`${this.config.height}px`),this.$el.style.setProperty("--width",`${this.config.width}px`),this.$el.style.setProperty("--currentDeg",`-${this.currentDeg}deg`)},autoTurn(){let t=360*Math.random()+21600;t-=t%this.rotate,this.targetDeg=t;const e=this.config.rollback?Math.random()*this.config.rollback+1:1;this.$el.style.setProperty("--targetDeg",`-${this.targetDeg}deg`),this.$el.style.setProperty("--rollBackDeg",`${e}`),this.isRunning=!0},autoTurnStop(){this.currentDeg=this.targetDeg%360,this.$el.style.setProperty("--currentDeg",`-${this.currentDeg}deg`);let t=null;const e=this.currentDeg+this.rotate/2;this.giftsDeg.forEach(((s,i)=>{e>=s.from&&e<=s.to&&(console.log(this.config.gifts[i].name),t=this.config.gifts[i].name)})),this.isRunning=!1,this.$emit("finished",t)}}};const w=(0,l.A)(E,[["render",$]]);var T=w,R={name:"DemoSlotMachine",components:{GiftDemo:T},data(){return{run3D:!1,trigger:null,active:!1,disabled:!1,selectedDirection:k[0],selectedBagua:D[k[0]][0],selectedSTEMS:C[D[k[0]][0]][0],configs:[{style:"gift-style",gifts:k.map((t=>({type:"text",name:t}))),duration:2e3,fontSize:150,height:200,width:200},{style:"gift-style",gifts:D[k[0]].map((t=>({type:"text",name:t}))),duration:4e3,fontSize:150,height:200,width:200},{style:"gift-style",gifts:C[D[k[0]][0]].map((t=>({type:"text",name:t}))),duration:6e3,fontSize:150,height:200,width:200}],openResultList:!1,resultList:[],result:[],value:1}},methods:{turn(){this.active=!0,setTimeout((()=>{this.active=!1}),500),this.disabled=!0,this.trigger=new Date},shuffle(t){for(let e=t.length-1;e>0;e--){const s=Math.floor(Math.random()*(e+1));[t[e],t[s]]=[t[s],t[e]]}return t},updateBagua(t){this.selectedDirection=t,this.selectedBagua=D[t][0],this.configs[1].gifts=D[t].map((t=>({type:"text",name:t}))),this.updateStemsBranches(this.selectedBagua)},updateStemsBranches(t){this.configs[2].gifts=C[t].map((t=>({type:"text",name:t})))},isFinished(t){const e=this.$el.querySelectorAll(".autoTurn");this.result.push(t),this.value=-this.value,1===e.length&&(this.disabled=!1,this.resultList.push(this.result),this.result=[])}},watch:{result:{handler(t){t.length>0&&this.updateBagua(t[0]),t.length>1&&(console.log("第二层结果:",t[1]),this.updateStemsBranches(t[1]))},deep:!0,immediate:!0}}};const X=(0,l.A)(R,[["render",v]]);var x=X;const P={id:"SlotMachine"},B={class:"body"},M={class:"window"},O={class:"container"},F={class:"resultList-container"};function _(t,e,s,a,o,r){const l=(0,n.g2)("GiftComponent");return(0,n.uX)(),(0,n.CE)("div",P,[e[7]||(e[7]=(0,n.Lk)("div",{class:"badge"},[(0,n.Lk)("span",null,"SlotMachine")],-1)),(0,n.Lk)("div",B,[(0,n.Lk)("div",M,[(0,n.Lk)("div",O,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.configs,((t,e)=>((0,n.uX)(),(0,n.Wv)(l,{onFinished:r.isFinished,trigger:o.trigger,config:t,key:e},null,8,["onFinished","trigger","config"])))),128)),e[3]||(e[3]=(0,n.Lk)("div",{class:"fence1"},null,-1)),e[4]||(e[4]=(0,n.Lk)("div",{class:"fence2"},null,-1))])]),(0,n.Lk)("div",{class:(0,g.C4)(["handler",{active:o.active},{disabled:o.disabled}])},[e[5]||(e[5]=(0,n.Lk)("div",{class:"stick2"},null,-1)),e[6]||(e[6]=(0,n.Lk)("div",{class:"stick"},null,-1)),(0,n.Lk)("div",{class:"ball",onClick:e[0]||(e[0]=t=>!o.disabled&&r.turn())})],2)]),(0,n.Lk)("div",{class:"history",onClick:e[1]||(e[1]=t=>o.openResultList=!0)}," OPEN RESULT "),(0,n.Lk)("div",{onClick:e[2]||(e[2]=(0,i.D$)((t=>o.openResultList=!1),["self"])),class:(0,g.C4)(["resultList",{openResultList:o.openResultList}])},[(0,n.Lk)("div",F,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.resultList,((t,e)=>((0,n.uX)(),(0,n.CE)("div",{class:"result",key:e},(0,g.v_)(`Round${e+1}: ${t}`),1)))),128))])],2)])}const I=["src","height"];function z(t,e,s,i,a,o){return(0,n.uX)(),(0,n.CE)("div",{class:(0,g.C4)(["gift-container",o.displayType,{autoTurn:a.isRunning}])},[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(s.config.gifts,((t,e)=>((0,n.uX)(),(0,n.CE)("div",{class:(0,g.C4)(["gift",s.config.style]),key:e,style:(0,g.Tr)(`transform: rotateX(${o.rotate*e}deg) translateZ(${o.translateZ}px)`)},["text"===t.type?((0,n.uX)(),(0,n.CE)(n.FK,{key:0},[(0,n.eW)((0,g.v_)(t.name),1)],64)):(0,n.Q3)("",!0),"image"===t.type?((0,n.uX)(),(0,n.CE)("img",{key:1,src:t.path,height:s.config.height},null,8,I)):(0,n.Q3)("",!0)],6)))),128))],2)}var j={name:"GiftComponent",props:{trigger:{type:Date,default:!1},config:{type:Object,required:!0}},data(){return{isRunning:!1,currentDeg:0,targetDeg:0,giftsDeg:[],finalValue:null}},computed:{displayType(){return this.config.run3D?"three-dimension":"flat"},rotate(){return 360/this.config.gifts.length},translateZ(){return this.config.height/2/Math.tan(this.rotate/2/180*Math.PI)}},watch:{config:{handler(){this.setConfig()},deep:!0},trigger(){this.autoTurn()},isRunning(){this.isRunning&&setTimeout((()=>{this.autoTurnStop()}),this.config.duration+200)},targetGifts:{handler(t){t&&t.length>0&&(this.finalValue=t[Math.floor(Math.random()*t.length)])},deep:!0,immediate:!0}},mounted(){this.setConfig(),this.logGiftsDeg()},unmounted(){console.log("组件已卸载")},methods:{logGiftsDeg(){console.log("Rotate: "+this.rotate),this.config.gifts.forEach(((t,e)=>{this.giftsDeg[e]={from:0===e?0:this.giftsDeg[e-1].to,to:0===e?this.rotate:this.giftsDeg[e-1].to+this.rotate,name:t.name}}))},setConfig(){this.$el.style.setProperty("--rotateY",`${this.config.rotateY}deg`),this.$el.style.setProperty("--duration",`${this.config.duration}ms`),this.$el.style.setProperty("--fontSize",`${this.config.fontSize}px`),this.$el.style.setProperty("--height",`${this.config.height}px`),this.$el.style.setProperty("--width",`${this.config.width}px`),this.$el.style.setProperty("--currentDeg",`-${this.currentDeg}deg`)},autoTurn(){let t=0;this.config.gifts.forEach(((e,s)=>{e.name===this.config.target&&(t=s)}));let e=1800+this.rotate*(this.config.gifts.length+t);e-=e%this.rotate,this.targetDeg=e,this.$el.style.setProperty("--targetDeg",`-${this.targetDeg}deg`),this.isRunning=!0},autoTurnStop(){this.currentDeg=this.targetDeg%360,this.$el.style.setProperty("--currentDeg",`-${this.currentDeg}deg`),this.isRunning=!1,this.$emit("finished",this.config.target)}}};const G=(0,l.A)(j,[["render",z]]);var K=G,A={name:"SlotMachine",components:{GiftComponent:K},data(){return{run3D:!1,trigger:null,active:!1,disabled:!1,selectedDirection:"",selectedBagua:"",selectedSTEMS:"",configs:[{style:"gift-style",gifts:k.map((t=>({type:"text",name:t}))),duration:1e3,fontSize:150,height:200,width:200,target:this.selectedDirection},{style:"gift-style",gifts:b.map((t=>({type:"text",name:t}))),duration:2e3,fontSize:150,height:200,width:200,target:this.selectedBagua},{style:"gift-style",gifts:L.map((t=>({type:"text",name:t}))),duration:3e3,fontSize:150,height:200,width:200,target:this.selectedSTEMS}],openResultList:!1,resultList:[],result:[],value:1}},methods:{async turn(){this.active=!0,setTimeout((()=>{this.active=!1}),500),this.disabled=!0,await this.fetchTargetConfig(),this.trigger=new Date},getRandomElement(t){return t[Math.floor(Math.random()*t.length)]},async fetchTargetConfig(){try{const t=await fetch("https://safe-river-06105-d768b9a417c0.herokuapp.com/config"),e=await t.json();this.selectedDirection=e.direction||this.getRandomElement(k),this.selectedBagua=e.bagua||this.getRandomElement(D[this.selectedDirection]),this.selectedSTEMS=e.stems||this.getRandomElement(C[this.selectedBagua]),console.log("Current Data is : "),console.log(e),this.configs=[{style:"gift-style",gifts:k.map((t=>({type:"text",name:t}))),duration:1e3,fontSize:150,height:200,width:200,target:this.selectedDirection},{style:"gift-style",gifts:b.map((t=>({type:"text",name:t}))),duration:2e3,fontSize:150,height:200,width:200,target:this.selectedBagua},{style:"gift-style",gifts:L.map((t=>({type:"text",name:t}))),duration:3e3,fontSize:150,height:200,width:200,target:this.selectedSTEMS}]}catch(t){console.error("❌ 获取数据失败:",t)}},isFinished(t){this.result.push(t),console.log("🎉 结果:",t),3===this.result.length&&(this.disabled=!1,this.resultList.push([...this.result]),this.result=[])}}};const Z=(0,l.A)(A,[["render",_]]);var Q=Z;const U={class:"container mt-4"},V={class:"card shadow"},W={class:"card-body"},Y={class:"mb-3"},q=["value"],N={class:"mb-3"},J=["disabled"],H=["value"],tt={class:"mb-3"},et=["disabled"],st=["value"],it={class:"d-grid"},nt=["disabled"];function at(t,e,s,a,o,r){return(0,n.uX)(),(0,n.CE)("div",U,[(0,n.Lk)("div",V,[e[12]||(e[12]=(0,n.Lk)("div",{class:"card-header bg-primary text-white"},[(0,n.Lk)("h4",{class:"mb-0"},"输入数据")],-1)),(0,n.Lk)("div",W,[(0,n.Lk)("form",null,[(0,n.Lk)("div",Y,[e[7]||(e[7]=(0,n.Lk)("label",{class:"form-label"},"方向",-1)),(0,n.bo)((0,n.Lk)("select",{class:"form-select","onUpdate:modelValue":e[0]||(e[0]=t=>o.selectedDirection=t),onChange:e[1]||(e[1]=(...t)=>r.updateBagua&&r.updateBagua(...t))},[e[6]||(e[6]=(0,n.Lk)("option",{disabled:"",value:""},"请选择方向",-1)),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.directions,(t=>((0,n.uX)(),(0,n.CE)("option",{key:t,value:t},(0,g.v_)(t),9,q)))),128))],544),[[i.u1,o.selectedDirection]])]),(0,n.Lk)("div",N,[e[9]||(e[9]=(0,n.Lk)("label",{class:"form-label"},"八卦",-1)),(0,n.bo)((0,n.Lk)("select",{class:"form-select","onUpdate:modelValue":e[2]||(e[2]=t=>o.selectedBagua=t),onChange:e[3]||(e[3]=(...t)=>r.updateStems&&r.updateStems(...t)),disabled:!o.selectedDirection},[e[8]||(e[8]=(0,n.Lk)("option",{disabled:"",value:""},"请选择八卦",-1)),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.baguaOptions,(t=>((0,n.uX)(),(0,n.CE)("option",{key:t,value:t},(0,g.v_)(t),9,H)))),128))],40,J),[[i.u1,o.selectedBagua]])]),(0,n.Lk)("div",tt,[e[11]||(e[11]=(0,n.Lk)("label",{class:"form-label"},"天干地支",-1)),(0,n.bo)((0,n.Lk)("select",{class:"form-select","onUpdate:modelValue":e[4]||(e[4]=t=>o.selectedStems=t),disabled:!o.selectedBagua},[e[10]||(e[10]=(0,n.Lk)("option",{disabled:"",value:""},"请选择天干地支",-1)),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.stemsOptions,(t=>((0,n.uX)(),(0,n.CE)("option",{key:t,value:t},(0,g.v_)(t),9,st)))),128))],8,et),[[i.u1,o.selectedStems]])]),(0,n.Lk)("div",it,[(0,n.Lk)("button",{class:"btn btn-success",onClick:e[5]||(e[5]=(0,i.D$)(((...t)=>r.saveConfig&&r.saveConfig(...t)),["prevent"])),disabled:!o.selectedStems}," Save ",8,nt)])])])])])}var ot={name:"InputPage",data(){return{directions:Object.keys(D),selectedDirection:"",selectedBagua:"",selectedStems:"",baguaOptions:[],stemsOptions:[]}},methods:{updateBagua(){this.selectedBagua="",this.selectedStems="",this.baguaOptions=D[this.selectedDirection]||[]},updateStems(){this.selectedStems="",this.stemsOptions=C[this.selectedBagua]||[]},async saveConfig(){try{const t=await fetch("https://safe-river-06105-d768b9a417c0.herokuapp.com/update-config",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({direction:this.selectedDirection,bagua:this.selectedBagua,stems:this.selectedStems})}),e=await t.json();e.success?alert("✅ 数据已存入 PostgreSQL！"):alert("❌ 数据保存失败："+e.error)}catch(t){console.error("保存失败",t),alert("❌ 请求失败，请检查服务器！")}}}};const rt=(0,l.A)(ot,[["render",at],["__scopeId","data-v-7db0fa7f"]]);var lt=rt;const ct=[{path:"/demo",name:"Demo",component:x},{path:"/",name:"SlotMachine",component:Q},{path:"/input",name:"Input",component:lt}],ut=(0,h.aE)({history:(0,h.Bt)(),routes:ct});var ht=ut;const gt=(0,i.Ef)(u);gt.use(ht),gt.mount("#app")}},e={};function s(i){var n=e[i];if(void 0!==n)return n.exports;var a=e[i]={exports:{}};return t[i].call(a.exports,a,a.exports,s),a.exports}s.m=t,function(){var t=[];s.O=function(e,i,n,a){if(!i){var o=1/0;for(u=0;u<t.length;u++){i=t[u][0],n=t[u][1],a=t[u][2];for(var r=!0,l=0;l<i.length;l++)(!1&a||o>=a)&&Object.keys(s.O).every((function(t){return s.O[t](i[l])}))?i.splice(l--,1):(r=!1,a<o&&(o=a));if(r){t.splice(u--,1);var c=n();void 0!==c&&(e=c)}}return e}a=a||0;for(var u=t.length;u>0&&t[u-1][2]>a;u--)t[u]=t[u-1];t[u]=[i,n,a]}}(),function(){s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,{a:e}),e}}(),function(){s.d=function(t,e){for(var i in e)s.o(e,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={524:0};s.O.j=function(e){return 0===t[e]};var e=function(e,i){var n,a,o=i[0],r=i[1],l=i[2],c=0;if(o.some((function(e){return 0!==t[e]}))){for(n in r)s.o(r,n)&&(s.m[n]=r[n]);if(l)var u=l(s)}for(e&&e(i);c<o.length;c++)a=o[c],s.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return s.O(u)},i=self["webpackChunkslot_machine_vue"]=self["webpackChunkslot_machine_vue"]||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))}();var i=s.O(void 0,[504],(function(){return s(873)}));i=s.O(i)})();
//# sourceMappingURL=app.13a7c366.js.map